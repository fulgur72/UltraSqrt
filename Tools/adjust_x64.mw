<?xml version="1.0" encoding="UTF-8"?>
<Worksheet>
<Version major="2017" minor="0"/>
<Label-Scheme value="2" prefix=""/>
<View-Properties presentation="false" autoexpanding_sections="true" UserProfileName="Maple Default Profile" NumericFormat-ApplyInteger="true" NumericFormat-ApplyRational="true" NumericFormat-ApplyExponent="false">
</View-Properties>
<MapleNet-Properties prettyprint="3" warnlevel="3" preplot="" helpbrowser="standard" contextmenusize="automatic" displayprecision="-1" echo="1" unitattributes="&quot;fontweight&quot; = &quot;bold&quot;" imaginaryunit="I" longdelim="true" elisiontermsthreshold="10000" elisiondigitsafter="100" elisiondigitsbefore="100" plotdevice="inline" errorbreak="1" plotoptions="" plotdriver="opengl" quiet="false" elisiontermsbefore="100" elisiontermsafter="100" screenwidth="79" indentamount="4" plotoutput="terminal" screenpixelheight="2160" rtablesize="10" useclientjvm="true" labelwidth="20" postplot="" typesetting="extended" ansi="false" elisiondigitsthreshold="10000" showassumed="1" errorcursor="false" labelling="true" screenheight="25" prompt="&gt; " verboseproc="1" latexwidth="8.0" ShowLabels="true"/>
<Styles>
<Font name="Heading 1" background="[255,255,255]" bold="true" executable="false" family="Times New Roma" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="18" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Warning" background="[255,255,255]" bold="false" executable="false" family="Courier New" foreground="[0,0,255]" italic="false" opaque="false" readonly="true" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="2D Output" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,255]" italic="false" opaque="false" readonly="true" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Heading 4" background="[255,255,255]" bold="false" executable="false" family="Times New Roma" foreground="[0,0,0]" italic="true" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Line Printed Output" background="[255,255,255]" bold="false" executable="false" family="Courier New" foreground="[0,0,255]" italic="false" opaque="false" readonly="true" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Heading 2" background="[255,255,255]" bold="true" executable="false" family="Times New Roma" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="16" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Maple Output" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="2D Inert Output" background="[255,255,255]" bold="false" executable="true" family="Times New Roman" foreground="[144,144,144]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Heading 3" background="[255,255,255]" bold="true" executable="false" family="Times New Roma" foreground="[0,0,0]" italic="true" opaque="false" readonly="false" size="14" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Diagnostic" background="[255,255,255]" bold="false" executable="false" family="Courier New" foreground="[40,120,40]" italic="false" opaque="false" readonly="true" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Ordered List 1" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Maple Input" background="[255,255,255]" bold="true" executable="true" family="Courier New" foreground="[255,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Text Output" background="[255,255,255]" bold="false" executable="false" family="Courier New" foreground="[0,0,255]" italic="false" opaque="false" readonly="true" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Ordered List 2" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Ordered List 3" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Ordered List 4" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Ordered List 5" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Annotation Title" background="[255,255,255]" bold="true" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="18" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Header and Footer" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="10" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="HyperlinkError" background="[255,255,255]" bold="false" executable="false" family="Courier New" foreground="[255,0,255]" italic="false" opaque="false" readonly="true" size="12" subscript="false" superscript="false" underline="true" placeholder="false"/>
<Font name="Atomic Variable" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[175,0,175]" italic="true" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="HyperlinkWarning" background="[255,255,255]" bold="false" executable="false" family="Courier New" foreground="[0,0,255]" italic="false" opaque="false" readonly="true" size="12" subscript="false" superscript="false" underline="true" placeholder="false"/>
<Font name="Dictionary Hyperlink" background="[255,255,255]" bold="false" executable="false" family="Times New Roma" foreground="[147,0,15]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="true" placeholder="false"/>
<Font name="2D Math" background="[255,255,255]" bold="false" executable="true" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Bullet Item" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Maple Plot" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Annotation Text" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="List Item" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Dash Item" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="2D Input" background="[255,255,255]" bold="false" executable="true" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Error" background="[255,255,255]" bold="false" executable="false" family="Courier New" foreground="[255,0,255]" italic="false" opaque="false" readonly="true" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Title" background="[255,255,255]" bold="true" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="18" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Text" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Normal" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Caption Reference" background="[255,255,255]" bold="true" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Code" background="[255,255,255]" bold="false" executable="false" family="Courier New" foreground="[255,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Maple Input Placeholder" background="[255,255,255]" bold="true" executable="true" family="Courier New" foreground="[200,0,200]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="true"/>
<Font name="Equation Label" background="[255,255,255]" bold="true" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Author" background="[255,255,255]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Font name="Hyperlink" background="[255,255,255]" bold="false" executable="false" family="Times New Roma" foreground="[0,128,128]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="true" placeholder="false"/>
<Font name="Caption Text" background="[255,255,255]" bold="true" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" opaque="false" readonly="false" size="12" subscript="false" superscript="false" underline="false" placeholder="false"/>
<Layout name="Heading 1" alignment="left" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="8" spacebelow="4" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Warning" alignment="left" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="0" spacebelow="0" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Heading 4" alignment="left" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="0" spacebelow="0" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Line Printed Output" alignment="left" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="0" spacebelow="0" linebreak="any" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Heading 2" alignment="left" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="8" spacebelow="2" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Maple Output" alignment="centred" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.3" spaceabove="0" spacebelow="0" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Heading 3" alignment="left" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="0" spacebelow="0" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Diagnostic" alignment="left" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="0" spacebelow="0" linebreak="any" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Ordered List 1" alignment="left" bullet="numeric" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="3" spacebelow="3" linebreak="space" pagebreak-before="false" initial="-1" bulletsuffix=""/>
<Layout name="Text Output" alignment="left" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="0" spacebelow="0" linebreak="newline" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Ordered List 2" alignment="left" bullet="alphabetic" firstindent="0" leftmargin="36" rightmargin="0" linespacing="0.0" spaceabove="3" spacebelow="3" linebreak="space" pagebreak-before="false" initial="-1" bulletsuffix=""/>
<Layout name="Ordered List 3" alignment="left" bullet="roman" firstindent="0" leftmargin="72" rightmargin="0" linespacing="0.0" spaceabove="3" spacebelow="3" linebreak="space" pagebreak-before="false" initial="-1" bulletsuffix=""/>
<Layout name="Ordered List 4" alignment="left" bullet="ALPHABETIC" firstindent="0" leftmargin="108" rightmargin="0" linespacing="0.0" spaceabove="3" spacebelow="3" linebreak="space" pagebreak-before="false" initial="-1" bulletsuffix=""/>
<Layout name="Ordered List 5" alignment="left" bullet="ROMAN" firstindent="0" leftmargin="144" rightmargin="0" linespacing="0.0" spaceabove="3" spacebelow="3" linebreak="space" pagebreak-before="false" initial="-1" bulletsuffix=""/>
<Layout name="Annotation Title" alignment="centred" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="12" spacebelow="12" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="HyperlinkError" alignment="left" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="0" spacebelow="0" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="HyperlinkWarning" alignment="left" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="0" spacebelow="0" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Bullet Item" alignment="left" bullet="dot" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="3" spacebelow="3" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Maple Plot" alignment="centred" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="0" spacebelow="0" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="List Item" alignment="left" bullet="indent" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="3" spacebelow="3" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Dash Item" alignment="left" bullet="dash" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="3" spacebelow="3" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Error" alignment="left" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="0" spacebelow="0" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Title" alignment="centred" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="12" spacebelow="12" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Normal" alignment="left" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="0" spacebelow="0" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Layout name="Author" alignment="centred" bullet="none" firstindent="0" leftmargin="0" rightmargin="0" linespacing="0.0" spaceabove="8" spacebelow="8" linebreak="space" pagebreak-before="false" initial="0" bulletsuffix=""/>
<Pencil-style name="Pencil 1" pen-color="[0,0,0]" pen-height="1.0" pen-width="1.0" pen-opacity="1.0"/>
<Pencil-style name="Pencil 2" pen-color="[0,0,255]" pen-height="1.0" pen-width="1.0" pen-opacity="1.0"/>
<Pencil-style name="Pencil 3" pen-color="[0,0,0]" pen-height="3.0" pen-width="3.0" pen-opacity="1.0"/>
<Pencil-style name="Pencil 4" pen-color="[0,0,255]" pen-height="3.0" pen-width="3.0" pen-opacity="1.0"/>
<Pencil-style name="Pencil 5" pen-color="[255,0,0]" pen-height="5.0" pen-width="5.0" pen-opacity="1.0"/>
<Highlighter-style name="Highlighter 5" pen-color="[255,255,0]" pen-height="48.0" pen-width="48.0" pen-opacity="0.8"/>
<Highlighter-style name="Highlighter 3" pen-color="[51,255,0]" pen-height="24.0" pen-width="24.0" pen-opacity="0.8"/>
<Highlighter-style name="Highlighter 4" pen-color="[0,255,255]" pen-height="32.0" pen-width="32.0" pen-opacity="0.8"/>
<Highlighter-style name="Highlighter 1" pen-color="[255,153,255]" pen-height="12.0" pen-width="8.0" pen-opacity="0.8"/>
<Highlighter-style name="Highlighter 2" pen-color="[255,204,0]" pen-height="14.0" pen-width="14.0" pen-opacity="0.8"/>
</Styles>
<Startup-Code startupcode="## BEGIN USER_PROFILE:\012## User profile imported from: Maple Default Profile\012## Warning, if you edit this code, make sure you remove the BEGIN and END tags.\012## For more information please see the user profile help page (?UserProfile)\012plots[setcolors](&quot;Classic&quot;):\012## END USER_PROFILE:\012"/>
<Task-table>
    <Task-category name="&lt;default&gt;"/>
</Task-table>
<Task/>
<Group labelreference="L1" drawlabel="true">
<Input><Text-field style="Text" layout="Normal"><Font size="18" underline="true" bold="true" family="Calibri">sqrt algorithm - next partial result adjust calculations</Font></Text-field>
</Input>
</Group>
<Section collapsed="true" isCollapsible="true" drawButton="true" MultipleChoiceAnswerIndex="-1" MultipleChoiceRandomizeChoices="false" TrueFalseAnswerIndex="-1" EssayAnswerRows="5" EssayAnswerColumns="60"><Title><Text-field style="Heading 1" layout="Heading 1"><Font size="14">Initial settings &amp; helpers</Font></Text-field></Title>
<Group autoexecute="true" labelreference="L32" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal">Digits := 50:
Size := 64:
DecGrSize := 27:
log2_10 := 28738/8651:</Text-field>
</Input>
</Group>
<Group autoexecute="true" labelreference="L35" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal">num2hexstr := proc(num::integer, len::integer)
  local hexstr;
  hexstr := convert(num, hex);
  while length(hexstr) &lt; len do
    hexstr := cat(&quot;0&quot;, hexstr);
  od;
  hexstr := convert(hexstr, string);
end:
xth := proc(num::integer)
  local ln, ord;
  ord := [ &quot;th&quot;, &quot;st&quot;, &quot;nd&quot;, &quot;rd&quot; ];
  ln := num mod 10;
  if ln &gt; 3 then ln := 0; fi;
  ord[ln+1];
end:
xWORD := proc()
  local szs;
  szs :=  [ &quot;h&quot;, &quot;S&quot;, &quot;Sh&quot;, &quot;D&quot;, &quot;Dh&quot;, &quot;T&quot;, &quot;Th&quot;, &quot;Q&quot;, &quot;X&quot; ];
  szs[min(nops(szs),Size/8)];
end:</Text-field>
</Input>
</Group>
<Group labelreference="L31" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal"></Text-field>
</Input>
</Group>
</Section>
<Section collapsed="true" isCollapsible="true" drawButton="true" MultipleChoiceAnswerIndex="-1" MultipleChoiceRandomizeChoices="false" TrueFalseAnswerIndex="-1" EssayAnswerRows="5" EssayAnswerColumns="60"><Title><Text-field style="Heading 1" layout="Heading 1"><Font size="14">Adjust probability code</Font></Text-field></Title>
<Group autoexecute="true" labelreference="L34" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal">adjust_prob := proc(sq::integer, figures::integer)
  global Size, DecGrSize, log2_10;
  local dec_sz, dec_fin_sz, bin_sz, bin_ovr_bits, bin_err_tv,
    ee, num, l, n, nn, p0, p1, p2, c0, c1, c2,
    sqr_i, sqr_f;
  dec_sz := DecGrSize*ceil(figures/DecGrSize);
  bin_sz := ceil(dec_sz*log2_10/Size);
  bin_ovr_bits := trunc(Size*bin_sz-dec_sz*log2_10);
  ee := trunc(log[4](sq));
  num := evalf(sqrt(sq)*2^(Size-1-ee));
  l := trunc(num);
  n := trunc((num-l)*2^Size);
  nn := 2^Size-1-n;
  if n = 0 then
    p0 := 1;
    p1 := 1;
  elif nn &lt;= l then
    p0 := evalf(1-nn/2/l);
    p1 := 1;
  elif nn &lt;= 2*l then
    p0 := evalf(l/2/nn);
    p1 := evalf(2-l/2/nn-nn/2/l);
  else
    p0 := evalf(l/2/nn);
    p1 := evalf(3*l/2/nn);
  fi;
  p2 := 1 - p1;
  p1 := p1 - p0;
  c2 := round(p2*bin_sz);
  c1 := round((p1+p2)*bin_sz)-c2;
  c0 := bin_sz-c1-c2;
  if bin_sz = 0 then
    l := l - (l mod 2);
    n := 0;
  fi;
<Font encoding="UTF-8">  printf(&quot;sqrt(%d)\134n&quot;,sq);
  printf(&quot;\134n&quot;);
  printf(&quot;* dec  fract part : %8d figure(s)\134n&quot;, dec_sz);
  printf(&quot;* bin  fract size : %8d %s-WORD(s)\134n&quot;, bin_sz, xWORD());
  printf(&quot;* bin  over sized : ||  + %2d bit(s)\134n&quot;,</Font> bin_ovr_bits);
<Font encoding="UTF-8">  printf(&quot;\134n&quot;);
  printf(&quot;* binary lead word: 0x%s\134n&quot;, num2hexstr(l, Size/4));
  printf(&quot;* binary next word: 0x%s\134n&quot;,</Font> num2hexstr(n, Size/4));
<Font encoding="UTF-8">  printf(&quot;* binary res shift: &lt;&lt;    %2d bit(s)\134n&quot;,</Font> (Size-1-ee));
<Font encoding="UTF-8">  printf(&quot;\134n&quot;);
  printf(&quot;~ next adapted +0 : %8d x %12.8f %%\134n&quot;, c0,</Font> 100*p0);
  printf(&quot;~ next adapted +1<Font encoding="UTF-8"> : %8d x %12.8f %%\134n&quot;, c1,</Font> 100*p1);
  printf(&quot;~ next adapted +2<Font encoding="UTF-8"> : %8d x %12.8f %%\134n&quot;, c2,</Font> 100*p2);
<Font encoding="UTF-8">  printf(&quot;* bin calc cycles : %8d # iter(s)\134n&quot;, bin_sz);
  printf(&quot;\134n&quot;);
  printf(&quot;* binary rem t-pos: %8d %s %s-WORD\134n&quot;, bin_sz, xth(bin_sz), xWORD());
  printf(&quot;&lt; binary rem t-val: 0x%s\134n&quot;, </Font>num2hexstr(l, Size/4));
  if n = 0 then
    bin_err_tv := 0;
  else
    bin_err_tv := trunc(bin_sz/8);
  fi;
<Font encoding="UTF-8">  printf(&quot;~ binary err t-val: 0x%s\134n&quot;, </Font>num2hexstr(bin_err_tv, Size/4));
<Font encoding="UTF-8">  printf(&quot;\134n&quot;);
  printf(&quot;* bi2dec start sz : %8d Q-WORD(s)\134n&quot;, bin_sz);
</Font>  if n = 0 then
    dec_fin_sz := 0;
  else
    dec_fin_sz := ceil(bin_sz+1-(dec_sz-DecGrSize)*log2_10/Size);
    dec_fin_sz := dec_fin_sz - `if`(dec_sz+ee mod Size &lt; DecGrSize, 1, 0);
    dec_fin_sz := min(bin_sz, dec_fin_sz);
  fi;
<Font encoding="UTF-8">  printf(&quot;* bi2dec final sz : %8d %s-WORD(s)\134n&quot;, dec_fin_sz</Font>, xWORD());
  printf(&quot;* dec calc cycles : <Font encoding="UTF-8">%8d # iter(s)\134n&quot;, dec_sz/</Font>DecGrSize);
<Font encoding="UTF-8">  printf(&quot;\134n&quot;);
</Font>  printf(&quot;? bi2dec rem 1-val: Ox0123456789ABCDEF<Font encoding="UTF-8">\134n&quot;);
</Font>  printf(&quot;? bi2dec next deci: 123456789123456789<Font encoding="UTF-8">\134n&quot;);
  printf(&quot;\134n&quot;);
</Font>  sqr_i := trunc(sqrt(sq));
  sqr_f := floor(evalf((sqrt(sq)-sqr_i)*10^DecGrSize));
<Font encoding="UTF-8">  printf(&quot;%d.\134n&quot;, sqr_i);
  printf(&quot;%0*d\134n&quot;, </Font>DecGrSize, sqr_f);
<Font encoding="UTF-8">  printf(&quot;\134n&quot;);
</Font>end:</Text-field>
</Input>
</Group>
<Group labelreference="L33" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal"></Text-field>
</Input>
</Group>
</Section>
<Section collapsed="true" isCollapsible="true" drawButton="true" MultipleChoiceAnswerIndex="-1" MultipleChoiceRandomizeChoices="false" TrueFalseAnswerIndex="-1" EssayAnswerRows="5" EssayAnswerColumns="60"><Title><Text-field style="Heading 1" layout="Heading 1"><Font size="14">Adjust find code</Font></Text-field></Title>
<Group autoexecute="true" labelreference="L37" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal">adjust_find := proc(st::integer, en::integer, expv::integer, sgn::integer, err::integer)
  global Size;
  local ee, num, l, n, sq;
  printf(&quot;Find 'lead' + 'next' ~=~ 0x%s<Font encoding="UTF-8"> - go from %d to %d\134n&quot;</Font>, num2hexstr(expv, Size/4), st, en);
<Font encoding="UTF-8">  printf(&quot;\134n&quot;);</Font>
  for sq from st to en do
    if sq &gt; trunc(sqrt(sq))^2 and sq mod 4 &gt; 0 then
      ee := trunc(log[4](sq));
      num := evalf(sqrt(sq)*2^(Size-1-ee));
      l := trunc(num);
      n := trunc((num-l)*2^Size);
      if abs(l+n-expv) &lt; err and (l+n-expv)*sgn &gt;= 0 then
        printf(&quot;%18d ~ 0x%s + 0x%s = 'expv<Font encoding="UTF-8">' %+18d (0x%s)\134n&quot;, sq, </Font>num2hexstr(l, Size/4), num2hexstr(n, Size/4), l+n-expv, num2hexstr(abs(l+n-expv), Size/4));
      fi;
    fi;
  od;
<Font encoding="UTF-8">  printf(&quot;\134n&quot;);</Font>
end:</Text-field>
</Input>
</Group>
<Group labelreference="L36" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal"></Text-field>
</Input>
</Group>
</Section>
<Section collapsed="true" isCollapsible="true" drawButton="true" MultipleChoiceAnswerIndex="-1" MultipleChoiceRandomizeChoices="false" TrueFalseAnswerIndex="-1" EssayAnswerRows="5" EssayAnswerColumns="60"><Title><Text-field style="Heading 1" layout="Heading 1">Figures</Text-field></Title>
<Group autoexecute="true" hide-input="false" labelreference="L57" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal"># Decimal figures
figures := 1000000;</Text-field>
</Input>
<Output><Text-field style="2D Output" layout="Maple Output"><Equation executable="false" style="2D Output" display="LUklbXJvd0c2Iy9JK21vZHVsZW5hbWVHNiJJLFR5cGVzZXR0aW5nR0koX3N5c2xpYkdGJzYmLUkjbWlHRiQ2JVEoZmlndXJlc0YnLyUnaXRhbGljR1EldHJ1ZUYnLyUsbWF0aHZhcmlhbnRHUSdpdGFsaWNGJy1JI21vR0YkNi1RKSZBc3NpZ247RicvRjNRJ25vcm1hbEYnLyUmZmVuY2VHUSZmYWxzZUYnLyUqc2VwYXJhdG9yR0Y9LyUpc3RyZXRjaHlHRj0vJSpzeW1tZXRyaWNHRj0vJShsYXJnZW9wR0Y9LyUubW92YWJsZWxpbWl0c0dGPS8lJ2FjY2VudEdGPS8lJ2xzcGFjZUdRLDAuMjc3Nzc3OGVtRicvJSdyc3BhY2VHRkwtSSNtbkdGJDYkUSgxMDAwMDAwRidGOUY5">LV9JLFR5cGVzZXR0aW5nRzYkJSpwcm90ZWN0ZWRHSShfc3lzbGliRzYiSSxtcHJpbnRzbGFzaEdGKDYkNyM+SShmaWd1cmVzR0YoIigrKysiNyNGLg==</Equation></Text-field>
</Output>
</Group>
<Group labelreference="L58" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal"></Text-field>
</Input>
</Group>
</Section>
<Section collapsed="true" isCollapsible="true" drawButton="true" MultipleChoiceAnswerIndex="-1" MultipleChoiceRandomizeChoices="false" TrueFalseAnswerIndex="-1" EssayAnswerRows="5" EssayAnswerColumns="60"><Title><Text-field style="Heading 1" layout="Heading 1">Adjust probablity cases</Text-field></Title>
<Group labelreference="L43" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal"># sqrt ( 2 )
adjust_prob(2, figures);</Text-field>
</Input>
</Group>
<Group labelreference="L42" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal"># sqrt ( 3 )
adjust_prob(3, figures);</Text-field>
</Input>
</Group>
<Group labelreference="L41" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal"># sqrt ( 5 )
adjust_prob(5, figures);</Text-field>
</Input>
</Group>
<Group labelreference="L40" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal"># sqrt ( 17 )
adjust_prob(17, figures);</Text-field>
</Input>
</Group>
<Group labelreference="L39" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal"># sqrt ( 19 )
adjust_prob(19, figures);</Text-field>
</Input>
</Group>
<Group labelreference="L38" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal"># sqrt ( 23 )
adjust_prob(23, figures);</Text-field>
</Input>
</Group>
<Group labelreference="L46" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal"># sqrt ( 2^32 - 1 ) - maximal value
adjust_prob(2^32-1, figures);</Text-field>
</Input>
</Group>
<Group labelreference="L47" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal"># sqrt ( 2^32 - 2 ) - maximal value - 1
adjust_prob(2^32-2, figures);</Text-field>
</Input>
</Group>
<Group labelreference="L48" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal"># sqrt ( 2^30 + 1 ) - max adjust
adjust_prob(2^30+1, figures);</Text-field>
</Input>
</Group>
<Group labelreference="L60" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal"># sqrt ( 2^30 - 1 ) - min adjust
adjust_prob(2^30-1, figures);</Text-field>
</Input>
</Group>
<Group labelreference="L61" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal"># sqrt ( 2^64 - 1 ) - maximal 64-bit value
adjust_prob(2^64-1, figures);</Text-field>
</Input>
</Group>
<Group labelreference="L62" drawlabel="true" applyint="true" applyrational="true" applyexponent="false">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal"># sqrt ( 2^64 - 2 ) - no adjust
adjust_prob(2^64-2, figures);</Text-field>
</Input>
</Group>
<Group labelreference="L63" drawlabel="true" applyint="true" applyrational="true" applyexponent="false">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal"></Text-field>
</Input>
</Group>
</Section>
<Section collapsed="true" isCollapsible="true" drawButton="true" MultipleChoiceAnswerIndex="-1" MultipleChoiceRandomizeChoices="false" TrueFalseAnswerIndex="-1" EssayAnswerRows="5" EssayAnswerColumns="60"><Title><Text-field style="Heading 1" layout="Heading 1">Adjust probability extremes</Text-field></Title>
<Group labelreference="L49" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal"># sqrt ( 2^30 + 1 ) - max adjust
# ***************************************************
# Explanation of &quot;max adjust&quot;:
# ==&gt; min lead: 2^63 + X
# ==&gt; next as low as possible
# &lt;== assume X := 2^32-1 then
# [ 2^63 + (2^32-1) ]^2 =
#  = 2^126 + 2^96 - 2^64 + 2^64 - 2^33 + 1 =
#  = 2^126 + 2^96 - 2^33 + 1 &lt; 2^126 + 2^96 =
#  = (2^30 + 1) * 2^96
# ==&gt; 2^30 + 1 will generate:
# * lead = 2^63 + (2^32-1)
# * next &gt;0 but small because
#    lead^2 &lt; (2^30 + 1) * 2^96 but difference is
#    small and therefore next will be also small
# ***************************************************
adjust_prob(2^30+1, figures);</Text-field>
</Input>
</Group>
<Group labelreference="L50" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal"># sqrt ( 2^30 - 1 ) - min adjust
# ***************************************************
# Explanation of &quot;min adjust&quot;:
# ==&gt; max lead: 2^64 - X
# ==&gt; next as high as possible
# &lt;== assume X := 2*(2^32+1) then
# [ 2^64 - 2*(2^32+1) ]^2 =
#  = 2^128 - 2^98 - 2^66 + 2^66 + 2^35 + 4 =
#  = 2^128 - 2^98 + 2^35 + 4 &gt; 2^128 - 2^98 =
#  = (2^30 - 1) * 2^98
# ==&gt; 2^30 - 1 will generate:
# * lead = 2^64 - 2*(2^32+1) - 1 because
#    (2^64-X)^2 &gt; (2^30-1) * 2^98 but difference is
#    small and therefore next will be close to 2^64
# * next only slightly less than 2^64
# ***************************************************
adjust_prob(2^30-1, figures);</Text-field>
</Input>
</Group>
<Group labelreference="L51" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal"># sqrt ( 2^62 + 1 ) - &quot;another&quot; min adjust
# ***************************************************
# Explanation:
# ==&gt; maximize next
# &lt;== assume lead := 2^63 + 1
# [ 2^63 + 1 ]^2 =
#  = 2^126 + 2^64 + 1 &gt; 2^126 + 2^64 =
#  = (2^62 + 1) * 2^64
# ==&gt; 2^62 + 1 will generate:
# * lead = 2^63 + 1 - 1 = 2^63 because
#    (2^63+1)^2 &gt; (2^62+1) * 2^64 but difference is
#    only 1 and therefore next will be 2^64-1
# * next = 2^64 - 1
# ***************************************************
adjust_prob(2^62+1, figures);</Text-field>
</Input>
</Group>
<Group labelreference="L52" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal"># sqrt ( 2^64 - 2 ) - &quot;another&quot; min adjust
# ***************************************************
# Explanation:
# ==&gt; maximize both lead and next
# &lt;== assume lead := 2^64 - 1
# [ 2^64 - 1 ]^2 =
#  = 2^128 - 2^65 + 1 &gt; 2^128 - 2^65 =
#  = (2^64 - 2) * 2^64
# ==&gt; 2^64 - 2 will generate:
# * lead = 2^64 - 1 - 1 = 2^64 - 2 because
#    (2^64-1)^2 &gt; (2^64-2) * 2^64 but difference is
#    only 1 and therefore next will be 2^64-1
# * next = 2^64 - 1
# ***************************************************
adjust_prob(2^64-2, figures);</Text-field>
</Input>
</Group>
<Group labelreference="L53" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal"></Text-field>
</Input>
</Group>
</Section>
<Section collapsed="true" isCollapsible="true" drawButton="true" MultipleChoiceAnswerIndex="-1" MultipleChoiceRandomizeChoices="false" TrueFalseAnswerIndex="-1" EssayAnswerRows="5" EssayAnswerColumns="60"><Title><Text-field style="Heading 1" layout="Heading 1">Adjust find cases</Text-field></Title>
<Group labelreference="L54" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal"># sqrt ( 2^30 + 1 ) - max adjust
# ***************************************************
# &lt;== Minimize lead + next ~=~ 2^63
# ***************************************************
adjust_find(2^28-2, 2^28+2, 2^63, 0, 2^48);
adjust_find(2^30-8, 2^30+8, 2^63, 0, 2^48);
adjust_prob(2^28+1, figures);
adjust_prob(2^30+1, figures);</Text-field>
</Input>
</Group>
<Group labelreference="L55" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal"># sqrt ( ??? ) - adjust at most 1x
# ***************************************************
# &lt;== Find lead + next ~=~ 2^64
# ***************************************************
# adjust_find(2, 2^18, 2^64, 1, 2^48);
adjust_prob(40429, figures);
adjust_prob(157387, figures);</Text-field>
</Input>
</Group>
<Group labelreference="L56" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal"></Text-field>
</Input>
</Group>
</Section>
<Group labelreference="L7" drawlabel="true">
<Input><Text-field prompt="&gt; " style="Maple Input" layout="Normal"></Text-field>
</Input>
</Group>
</Worksheet>